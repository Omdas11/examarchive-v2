<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Upload Paper · ExamArchive</title>

  <!-- Global styles -->
  <link rel="stylesheet" href="css/common.css">
  <link rel="stylesheet" href="css/brand.css">
  <link rel="stylesheet" href="css/header.css">
  <link rel="stylesheet" href="css/footer.css">
  <link rel="stylesheet" href="css/profile-panel.css">
  <link rel="stylesheet" href="css/levelup.css">
  <link rel="stylesheet" href="css/avatar-popup.css">
  <link rel="stylesheet" href="css/avatar.css">

  <!-- Page-specific -->
  <link rel="stylesheet" href="css/upload.css">
  <link rel="stylesheet" href="css/dropdown.css">

  <!-- Accessibility and SEO -->
  <meta name="description" content="Upload university question papers to help fellow students." />
  <meta name="theme-color" content="#d32f2f" />
  <link rel="canonical" href="https://examarchive.in/upload.html" />

  <!-- Open Graph -->
  <meta property="og:title" content="Upload Paper | ExamArchive" />
  <meta property="og:description" content="Upload university question papers to help fellow students." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://examarchive.in/upload.html" />
  <meta property="og:site_name" content="ExamArchive" />
</head>
<body>

  <!-- Skip to content link for accessibility -->
  <a href="#main-content" class="sr-only sr-only-focusable">Skip to main content</a>

  <!-- Header -->
  <div id="night-layer"></div>
  <div id="header"></div>

  <main class="upload-page container" id="main-content">

    <!-- ================= SIGN-IN OVERLAY ================= -->
    <section id="upload-auth-wall" class="upload-auth-wall card" style="display:none; text-align:center; padding:2rem 1.5rem;">
      <h2>Sign in Required</h2>
      <p class="text-muted" style="margin-bottom:1rem;">
        You need to sign in before you can upload question papers.
      </p>
      <button id="uploadSignInBtn" class="btn btn-red" style="margin:0 auto;">
        Sign In to Upload
      </button>
    </section>

    <!-- ================= HEADER ================= -->
    <section class="upload-intro" style="display:none;">
      <h1>Upload to ExamArchive</h1>
      <p class="text-muted">
        Help fellow students by uploading question papers, repeated questions, or study resources.
      </p>
    </section>

    <!-- ================= UPLOAD TYPE SELECTOR ================= -->
    <section class="upload-type-selector card" style="display:none;">
      <h2>Select Upload Type</h2>
      <div class="type-options">
        <label class="type-option active" data-type="question-paper">
          <input type="radio" name="upload-type" value="question-paper" checked />
          <div class="type-content">
            <div class="type-icon"><span class="svg-icon" aria-hidden="true"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg></span></div>
            <div class="type-info">
              <strong>Question Paper</strong>
              <small>Upload previous year question papers (PDF)</small>
            </div>
          </div>
        </label>
        
        <label class="type-option disabled" data-type="notes-resources">
          <input type="radio" name="upload-type" value="notes-resources" disabled />
          <div class="type-content">
            <div class="type-icon"><span class="svg-icon" aria-hidden="true"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 016.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 014 19.5v-15A2.5 2.5 0 016.5 2z"/></svg></span></div>
            <div class="type-info">
              <strong>Notes / Resources</strong>
              <small>Coming in future phase</small>
            </div>
          </div>
        </label>
      </div>
    </section>

    <!-- ================= UPLOAD CARD ================= -->
    <section class="upload-card card" style="display:none;">

      <!-- STEP 1 -->
      <div class="upload-step">
        <h2>Paper details</h2>

        <label class="field">
          <span class="field-label">University</span>
          <select id="university" data-ea-dropdown>
            <option value="">Select University</option>
            <option value="assam-university">Assam University</option>
            <option value="other">Other</option>
          </select>
        </label>

        <label class="field">
          <span class="field-label">Stream</span>
          <select id="stream" data-ea-dropdown>
            <option value="">Select Stream</option>
            <option value="science">Science</option>
            <option value="arts">Arts</option>
            <option value="commerce">Commerce</option>
          </select>
        </label>

        <label class="field">
          <span class="field-label">Programme</span>
          <select id="programme" data-ea-dropdown>
            <option value="">Select Programme</option>
            <option value="fyug">FYUG (4-Year)</option>
            <option value="pg">PG (Post Graduate)</option>
            <option value="honours">Honours</option>
            <option value="general">General</option>
          </select>
        </label>

        <label class="field">
          <span class="field-label">Subject</span>
          <input
            id="subject"
            type="text"
            placeholder="e.g. Physics"
            required
          />
          <small class="field-hint">
            Enter the subject name as printed on the paper.
          </small>
        </label>

        <label class="field">
          <span class="field-label">Paper / Subject Code</span>
          <input
            id="paperCode"
            type="text"
            placeholder="e.g. PHYDSC102T"
            required
          />
          <small class="field-hint">
            Use the official paper code printed on the question paper.
          </small>
        </label>

        <label class="field">
          <span class="field-label">Examination Year</span>
          <div class="field-input-wrap">
            <input
              id="examYear"
              type="number"
              placeholder="e.g. 2023"
              min="1990"
              max="2099"
              required
            />
            <span class="field-validation-icon" id="yearValidationIcon" role="status" aria-live="polite" aria-label="Validation status"></span>
          </div>
          <small class="field-hint year-hint" id="yearHint"></small>
        </label>

        <label class="field">
          <span class="field-label">Paper Type</span>
          <select id="paperType" data-ea-dropdown>
            <option value="main">Main Examination</option>
            <option value="supplementary">Supplementary</option>
            <option value="internal">Internal</option>
          </select>
        </label>

        <label class="field">
          <span class="field-label">Semester</span>
          <select id="semester" data-ea-dropdown>
            <option value="">Select Semester</option>
            <option value="1">Semester 1</option>
            <option value="2">Semester 2</option>
            <option value="3">Semester 3</option>
            <option value="4">Semester 4</option>
            <option value="5">Semester 5</option>
            <option value="6">Semester 6</option>
            <option value="7">Semester 7</option>
            <option value="8">Semester 8</option>
          </select>
        </label>

        <label class="field">
          <span class="field-label">Tags</span>
          <input
            id="tags"
            type="text"
            placeholder="e.g. mid-term, 2023, physics, unit-3"
          />
          <small class="field-hint">
            Comma-separated tags to help others find this paper.
          </small>
        </label>

        <label class="field">
          <span class="field-label">Rename File (optional)</span>
          <input
            id="fileRename"
            type="text"
            placeholder="e.g. PHYDSC102T-2023-main"
          />
          <small class="field-hint">
            Custom filename for the uploaded file. Leave empty for auto-generated name.
          </small>
        </label>
      </div>

      <!-- STEP 2 -->
      <div class="upload-step">
        <h2>Upload PDF</h2>

        <label class="file-drop" id="fileDropZone">
          <input
            type="file"
            accept="application/pdf"
            required
            hidden
          />

          <div class="file-ui" id="fileUI">
            <svg class="upload-cloud-icon" viewBox="0 0 48 48" width="48" height="48" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
              <path d="M14 36c-4.42 0-8-3.58-8-8 0-3.7 2.5-6.8 5.9-7.7C12.6 14.5 17.8 10 24 10c7.18 0 13 5.82 13 13 0 .34-.01.67-.04 1H38c3.31 0 6 2.69 6 6s-2.69 6-6 6H14z"/>
              <path d="M24 22v14M18 28l6-6 6 6" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <strong>Select PDF file</strong>
            <p class="text-muted">
              Drag &amp; drop or click · PDF only · Clear scan preferred
            </p>
          </div>
        </label>

        <!-- Filename preview -->
        <div class="filename-preview" id="filenamePreview" style="display:none;"></div>
      </div>

      <!-- STEP 3 -->
      <div class="upload-step upload-submit">
        <button type="submit" class="btn btn-red">
          Upload Paper
        </button>

        <p class="upload-note text-muted">
          Uploaded papers are reviewed before appearing publicly.
        </p>
      </div>

    </section>

    <!-- ================= FUTURE INFO ================= -->
    <section class="upload-info card" style="display:none;">
      <h2>Upload guidelines</h2>
      <ul class="text-muted">
        <li>Ensure all pages are visible and upright</li>
        <li>Avoid cropped or blurry images</li>
        <li>One paper per upload</li>
        <li>Incorrect uploads may be removed</li>
      </ul>
    </section>

  </main>

  <!-- Footer -->
  <div id="footer"></div>

  <!-- Global portals -->
  <div id="avatar-portal"></div>
  <div id="profile-panel-portal"></div>

  <!-- Scripts -->
  <!-- ⚡ BOOTSTRAP (MUST BE FIRST) -->
  <script src="js/bootstrap.js"></script>
  
  <!-- Supabase SDK (Auth + DB only) -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.93.3"></script>

  <!-- Appwrite SDK (File Storage) -->
  <script src="https://cdn.jsdelivr.net/npm/appwrite@13/dist/iife/sdk.js"></script>
  <script src="js/appwrite-client.js"></script>
  
  <!-- ⚡ SUPABASE CLIENT SINGLETON (Phase 1.4 - MUST LOAD BEFORE MODULES) -->
  <script src="js/supabase-client.js"></script>
  <script src="js/core/auth-ready.js"></script>
  <script src="js/core/debug.js"></script>
  
  <!-- ⚡ SUPABASE INITIALIZATION (Phase 9.2.4) -->
  <script type="module" src="js/app.module.js"></script>
  
  <!-- Classic Scripts (NO type="module") -->
  <!-- ⚡ AUTH UTILITIES (Phase 9.2) -->
  <script src="js/utils/supabase-wait.js"></script>
  <script src="js/utils/role-utils.js"></script>
  <script src="js/auth-controller.js"></script>
  
  <script src="js/common.js"></script>
  <script src="js/icon-fallback.js"></script>
  <script src="js/avatar-utils.js"></script>
  <script src="js/svg-icons.js"></script>
  <script src="js/roles.js"></script>
  <script src="js/admin-auth.js"></script>
  <script src="js/upload-handler.js"></script>
  <script src="js/profile-panel.js"></script>
  <script src="js/levelup.js"></script>
  <script src="js/avatar-popup.js"></script>
  <script src="js/upload.js"></script>
  <script src="js/dropdown.js"></script>
  <script src="js/theme.js"></script>

</body>
  </html>
