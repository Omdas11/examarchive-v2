<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Upload Paper Â· ExamArchive</title>

  <!-- Global styles -->
  <link rel="stylesheet" href="css/common.css">
  <link rel="stylesheet" href="css/brand.css">
  <link rel="stylesheet" href="css/header.css">
  <link rel="stylesheet" href="css/footer.css">
  <link rel="stylesheet" href="css/profile-panel.css">
  <link rel="stylesheet" href="css/avatar-popup.css">
  <link rel="stylesheet" href="css/avatar.css">

  <!-- Page-specific -->
  <link rel="stylesheet" href="css/upload.css">

  <!-- Accessibility and SEO -->
  <meta name="description" content="Upload university question papers to help fellow students." />
  <meta name="theme-color" content="#d32f2f" />
</head>
<body>

  <!-- Skip to content link for accessibility -->
  <a href="#main-content" class="sr-only sr-only-focusable">Skip to main content</a>

  <!-- Header -->
  <div id="night-layer"></div>
  <div id="header"></div>

  <main class="upload-page container" id="main-content">

    <!-- ================= HEADER ================= -->
    <section class="upload-intro">
      <h1>Upload to ExamArchive</h1>
      <p class="text-muted">
        Help fellow students by uploading question papers, repeated questions, or study resources.
      </p>
    </section>

    <!-- ================= UPLOAD TYPE SELECTOR ================= -->
    <section class="upload-type-selector card">
      <h2>Select Upload Type</h2>
      <div class="type-options">
        <label class="type-option active" data-type="question-paper">
          <input type="radio" name="upload-type" value="question-paper" checked />
          <div class="type-content">
            <div class="type-icon">ðŸ“„</div>
            <div class="type-info">
              <strong>Question Paper</strong>
              <small>Upload previous year question papers (PDF)</small>
            </div>
          </div>
        </label>
        
        <label class="type-option" data-type="demo-paper">
          <input type="radio" name="upload-type" value="demo-paper" />
          <div class="type-content">
            <div class="type-icon">ðŸ§ª</div>
            <div class="type-info">
              <strong>Demo Paper</strong>
              <small>Auto-approved demo upload, visible immediately</small>
            </div>
          </div>
        </label>
        
        <label class="type-option disabled" data-type="notes-resources">
          <input type="radio" name="upload-type" value="notes-resources" disabled />
          <div class="type-content">
            <div class="type-icon">ðŸ“š</div>
            <div class="type-info">
              <strong>Notes / Resources</strong>
              <small>Coming in future phase</small>
            </div>
          </div>
        </label>
      </div>
    </section>

    <!-- ================= UPLOAD CARD ================= -->
    <section class="upload-card card">

      <!-- STEP 1 -->
      <div class="upload-step">
        <h2>Paper details</h2>

        <label class="field">
          <span class="field-label">Paper / Subject Code</span>
          <input
            id="paperCode"
            type="text"
            placeholder="e.g. PHYDSC102T"
            required
          />
          <small class="field-hint">
            Use the official paper code printed on the question paper.
          </small>
        </label>

        <label class="field">
          <span class="field-label">Examination Year</span>
          <div class="field-input-wrap">
            <input
              id="examYear"
              type="number"
              placeholder="e.g. 2023"
              min="1990"
              max="2099"
              required
            />
            <span class="field-validation-icon" id="yearValidationIcon" role="status" aria-live="polite" aria-label="Validation status"></span>
          </div>
          <small class="field-hint year-hint" id="yearHint"></small>
        </label>
      </div>

      <!-- STEP 2 -->
      <div class="upload-step">
        <h2>Upload PDF</h2>

        <label class="file-drop" id="fileDropZone">
          <input
            type="file"
            accept="application/pdf"
            required
            hidden
          />

          <div class="file-ui" id="fileUI">
            <svg class="upload-cloud-icon" viewBox="0 0 48 48" width="48" height="48" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
              <path d="M14 36c-4.42 0-8-3.58-8-8 0-3.7 2.5-6.8 5.9-7.7C12.6 14.5 17.8 10 24 10c7.18 0 13 5.82 13 13 0 .34-.01.67-.04 1H38c3.31 0 6 2.69 6 6s-2.69 6-6 6H14z"/>
              <path d="M24 22v14M18 28l6-6 6 6" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <strong>Select PDF file</strong>
            <p class="text-muted">
              Drag &amp; drop or click Â· PDF only Â· Clear scan preferred
            </p>
          </div>
        </label>

        <!-- Filename preview -->
        <div class="filename-preview" id="filenamePreview" style="display:none;"></div>
      </div>

      <!-- STEP 3 -->
      <div class="upload-step upload-submit">
        <button type="submit" class="btn btn-red">
          Upload Paper
        </button>

        <p class="upload-note text-muted">
          Uploaded papers are reviewed before appearing publicly.
        </p>
      </div>

    </section>

    <!-- ================= FUTURE INFO ================= -->
    <section class="upload-info card">
      <h2>Upload guidelines</h2>
      <ul class="text-muted">
        <li>Ensure all pages are visible and upright</li>
        <li>Avoid cropped or blurry images</li>
        <li>One paper per upload</li>
        <li>Incorrect uploads may be removed</li>
      </ul>
    </section>

  </main>

  <!-- Footer -->
  <div id="footer"></div>

  <!-- Global portals -->
  <div id="avatar-portal"></div>
  <div id="profile-panel-portal"></div>

  <!-- Scripts -->
  <!-- âš¡ BOOTSTRAP (MUST BE FIRST) -->
  <script src="js/bootstrap.js"></script>
  
  <!-- Supabase SDK -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.93.3"></script>
  
  <!-- âš¡ SUPABASE CLIENT SINGLETON (Phase 1.4 - MUST LOAD BEFORE MODULES) -->
  <script src="js/supabase-client.js"></script>
  <script src="js/core/auth-ready.js"></script>
  <script src="js/core/debug.js"></script>
  
  <!-- âš¡ SUPABASE INITIALIZATION (Phase 9.2.4) -->
  <script type="module" src="js/app.module.js"></script>
  
  <!-- Classic Scripts (NO type="module") -->
  <!-- âš¡ AUTH UTILITIES (Phase 9.2) -->
  <script src="js/utils/supabase-wait.js"></script>
  <script src="js/utils/role-utils.js"></script>
  <script src="js/auth-controller.js"></script>
  
  <script src="js/common.js"></script>
  <script src="js/avatar-utils.js"></script>
  <script src="js/roles.js"></script>
  <script src="js/admin-auth.js"></script>
  <script src="js/upload-handler.js"></script>
  <script src="js/profile-panel.js"></script>
  <script src="js/avatar-popup.js"></script>
  <script src="js/upload.js"></script>
  <script src="js/theme.js"></script>

</body>
  </html>
